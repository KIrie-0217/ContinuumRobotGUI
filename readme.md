# 概要
連続体ロボット制御用ソフトウェアです

1. modules  
    中で動かす制御周りです
2. gui  
    GUIです

# 操作方法

## 起動

1. ターミナルから  

    cd workspace/CR/gui  
    ./gui

    を実行します  
2. TS-01の電源スイッチを入れます（感電に注意してください）
3. 少し待ってからModulesタブ内のctrlをクリックしてTS-01とPCをつなげます
4. 別のターミナルで  
    cd workspace/Arduino  
    python3 Readbypy.py  
    pw:kklab  
    としてArduino-PC接続を実行します

以上によりロボットの動作準備が完了です.  
次に実際にロボットを動かしていきます

## モーターテスト

1. ModeのFKをクリックしテストモードにします
2. Referenceから任意の波形を決定します（モータ番号は実機に書いてある番号-1としてください;0始まりのため）  
    **※このとき大きい値を設定するとワイヤ破断の恐れがあるので小さな値から試してください**
3. SERVO_ON　をクリックします
4. 安全のためにRESET_ORIGINをクリックしてエンコーダの値を初期化します
5. START　をクリックして実行します

## 実動作

1. ModeをTaskにします 
2. SERVO_ONをクリックします
3. 1:INITをクリックします（原点出しタスクです）
4. UNLOCKをクリックします
5. STARTをクリックすると原点出し動作が始まります.
6. 原点だしが完了したらSTOPを押します
7. (DATA/DEMO/CONTROL_MODE)から動作させたいモードをクリックします  
    DATAモードではここで読み込みたいデータも設定してください
8. UNLOCKをクリックします
9. スタートを押すことで動作が完了します. 

動作完了後はモータテストの波形を定常（直線のやつ）,baseを-5程度にすべてのモータを設定して実行してください（ワイヤが張った状態のままだと破断する恐れがあります）  


# 動作モードの説明
モードにはDATA/DEMO/CONTROL_MODEの3種類が存在します、これについて説明します

## DATAモード
.datファイルから指令値データを読み込むモードです  
.datファイルは /CR/gui直下に保存してください  
/CR/modules/ctrl_module.cpp 154行目あたりを読み込みたいファイル名に書き換えてください.多分めんどくさいと思うので余裕があったら読み込みやすくgui変えてください  
.datファイルの形式はN行,9列の形式にしてください（すでにあるのを参考にしてください）  
1行目が0番目モータに相当します  
.datファイルはMatlabの運動学やColabolatoryの運動学から生成してください  

operationタブのテキストボックスに行数を書いて,Reload(mode:DATA)をクリックすることで更新ができます,スタートを押す前に実行してください

## DEMOモード
修論で使ったデモ動作をするモードです屹立→S字→直線に偏移します.  

## CONTROL_MODE
各モータを手動で動作させたいときに使うモードです  
Operationタブのテキストボックスからワイヤ引き量を記入しPUSHを押すことで実行されます.  
**※※ワイヤ引き量は+=なことに注意してください※※**  
**※※ワイヤ引き量はmmです、最初は0.5mmなど小さい値で試してください※※**  
Reloadボタンを押すことで現在のワイヤ引き量を確認できます.  